<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0 viewport-fit=cover"
    />
    <title>ProcedureBot</title>
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="{{url_for('static',filename='images/apple-touch-icon.png')}}"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="{{url_for('static',filename='images/favicon-32x32.png')}}"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="{{url_for('static',filename='images/favicon-16x16.png')}}"
    />
    <link
      rel="manifest"
      href="{{url_for('static',filename='images/site.webmanifest')}}"
    />
    <meta name="msapplication-TileColor" content="#da532c" />

    <!--Fonts-->
    <link
      href="https://fonts.googleapis.com/css2?family=Alata&display=swap"
      rel="stylesheet"
    />
    <!--Tailwind ting-->
    <link
      href="{{url_for('static',filename='css/output.css')}}"
      rel="stylesheet"
    />
  </head>
  <body class="h-screen bg-neutral-100" style="font-family: 'Alata'">
    {% if session %}
    <header>
      <div class="flex justify-center">
        <!--Header section-->
        <nav class="text-center font-extrabold text-forth p-4">
          <h1 style="font-family: 'Alata', sans-serif" class="text-7xl">
            ProcedureBot
          </h1>
          <h1 style="font-family: 'Alata', sans-serif" class="text-5xl">
            Welcome {{session.userinfo.name}}
          </h1>
          <p
            class="text-forth border border-forth px-4 m-4 hover:text-white hover:bg-forth"
          >
            <a href="/logout">LOGOUT</a>
          </p>
        </nav>
      </div>
    </header>
    <main class="p-4">
      <!--Description Section-->
      <section>
        <div
          class="px-2 2xl:px-4 xl:px-4 lg:px-4 text-sm 2xl:text-base xl:text-base lg:text-base mb-4"
        >
          <span class="flex items-start justify-center text-center">
            <p>
              ProcedureBot is your dedicated assistant for navigating the
              essential steps of adulthood. Whether you're exploring university
              programs, applying for a passport, obtaining a KRA PIN, or
              handling healthcare and legal procedures in Kenya, ProcedureBot
              provides the guidance you need to proceed with confidence.
              <br />
              Built on cutting-edge natural language processing and deep
              industry knowledge, ProcedureBot delivers clear, accurate, and
              empathetic assistance at every step. Start your journey with
              ProcedureBot today and experience seamless support as you tackle
              the procedures that matter most.
            </p>
          </span>
        </div>
      </section>

      <!--Chat Area-->
      <section>
        <div
          class="border rounded-lg min-h-96 max-h-96 border-forth flex-col flex-shrink-0 bg-second py-2 2xl:p-4 xl:p-4 lg:p-4 overflow-auto"
        >
          <div class="flex flex-col h-full overflow-x-auto">
            <div class="flex flex-col h-full">
              <div id="chatbox" class="grid grid-cols-12 gap-y-2">
                <!--Bot's text-->
                <div class="col-start-1 col-end-10 p-2">
                  <div class="flex flex-row items-start">
                    <p
                      class="relative min-h-10 ml-2 text-sm bg-white py-2 px-2 2xl:px-4 xl:px-4 lg:px-4 shadow rounded-tl-lg rounded-tr-lg rounded-br-lg"
                    >
                      Hey there!
                    </p>
                  </div>
                </div>

                <!--User's text-->
              </div>
              <div id="userInput"></div>
            </div>
          </div>
        </div>
        <div class="flex h-full py-2 2xl:py-4 xl:py-4 lg:py-4">
          <input
            type="text"
            id="textInput"
            placeholder="Write your question here..."
            class="p-2 rounded-lg bg-gray-50 border border-forth text-gray-900 text-sm focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5"
          />
          <button
            id="send"
            class="flex rounded-lg items-center ml-2 2xl:ml-4 xl:ml-4 lg:ml-4 bg-forth text-white px-4"
          >
            <svg
              class="w-6 h-6 text-white"
              aria-hidden="true"
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              fill="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                fill-rule="evenodd"
                d="M12 2a1 1 0 0 1 .932.638l7 18a1 1 0 0 1-1.326 1.281L13 19.517V13a1 1 0 1 0-2 0v6.517l-5.606 2.402a1 1 0 0 1-1.326-1.281l7-18A1 1 0 0 1 12 2Z"
                clip-rule="evenodd"
              />
            </svg>
            send
          </button>
        </div>
      </section>
    </main>
    <footer class="bg-forth rounded-lg text-white mt-8 m-4 px-4 py-2">
      <div class="flex py-2 items-center">
        <h1 class="text-2xl pr-4" style="font-family: 'Alata'">ProcedureBot</h1>
        <a
          class="no-underline"
          href="https://github.com/injili/ProcedureBot"
          target="_blank"
        >
          <svg
            class="w-6 h-6"
            aria-hidden="true"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              fill-rule="evenodd"
              d="M12.006 2a9.847 9.847 0 0 0-6.484 2.44 10.32 10.32 0 0 0-3.393 6.17 10.48 10.48 0 0 0 1.317 6.955 10.045 10.045 0 0 0 5.4 4.418c.504.095.683-.223.683-.494 0-.245-.01-1.052-.014-1.908-2.78.62-3.366-1.21-3.366-1.21a2.711 2.711 0 0 0-1.11-1.5c-.907-.637.07-.621.07-.621.317.044.62.163.885.346.266.183.487.426.647.71.135.253.318.476.538.655a2.079 2.079 0 0 0 2.37.196c.045-.52.27-1.006.635-1.37-2.219-.259-4.554-1.138-4.554-5.07a4.022 4.022 0 0 1 1.031-2.75 3.77 3.77 0 0 1 .096-2.713s.839-.275 2.749 1.05a9.26 9.26 0 0 1 5.004 0c1.906-1.325 2.74-1.05 2.74-1.05.37.858.406 1.828.101 2.713a4.017 4.017 0 0 1 1.029 2.75c0 3.939-2.339 4.805-4.564 5.058a2.471 2.471 0 0 1 .679 1.897c0 1.372-.012 2.477-.012 2.814 0 .272.18.592.687.492a10.05 10.05 0 0 0 5.388-4.421 10.473 10.473 0 0 0 1.313-6.948 10.32 10.32 0 0 0-3.39-6.165A9.847 9.847 0 0 0 12.007 2Z"
              clip-rule="evenodd"
            />
          </svg>
        </a>
      </div>
      <p>
        <small>
          © 2024 ProcedureBot | built with ♥ by Carla, Kabarak University.
        </small>
      </p>
    </footer>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      function getBotResponse() {
        let rawText = $("#textInput").val();
        let userHtml =
          '<div class="col-start-4 col-end-13 p-2 ">' +
          '<div class="flex items-start justify-start flex-row-reverse">' +
          '<p class="relative min-h-10 mr-2 text-white text-sm bg-forth py-2 px-2 2xl:px-4 xl:px-4 lg:px-4 shadow rounded-tl-lg rounded-tr-lg rounded-bl-lg">' +
          rawText +
          "</p></div></div>";
        $("#textInput").val("");
        $("#chatbox").append(userHtml);
        document
          .getElementById("userInput")
          .scrollIntoView({ block: "start", behavior: "smooth" });
        $.get("/get", { msg: rawText }).done(function (data) {
          var botHtml =
            '<div class="col-start-1 col-end-10 p-2 ">' +
            '<div class="flex flex-row items-start">' +
            '<div class="relative flex flex-col min-h-10 ml-2 text-sm bg-white py-2 px-2 2xl:px-4 xl:px-4 lg:px-4 shadow rounded-tl-lg rounded-tr-lg rounded-br-lg ">' +
            data +
            "</div></div></div>";
          $("#chatbox").append(botHtml);
          document
            .getElementById("userInput")
            .scrollIntoView({ block: "start", behavior: "smooth" });
        });
      }
      document
        .getElementById("send")
        .addEventListener("click", handleButtonClick);

      function handleButtonClick() {
        const inputText = document.getElementById("textInput").value;
        if (inputText.trim() !== "") {
          getBotResponse();
        }
      }

      $("#textInput").keypress(function (e) {
        if (e.which === 13) {
          const inputText = document.getElementById("textInput").value;
          if (inputText.trim() !== "") {
            getBotResponse();
          }
        }
      });
    </script>
    {% else %}
    <div class="flex flex-col gap-8 items-center justify-center h-full w-full">
      <h1 class="text-center font-extrabold text-forth text-9xl p-4">
        WELCOME TO<br />PROCEDUREBOT
      </h1>
      <p
        class="text-forth font-bold text-5th border border-2 border-forth p-4 hover:text-white hover:bg-forth"
      >
        <a href="/login">LOGIN</a>
      </p>
      <p class="text-forth">Built And Maintained by Carla Cheruto</p>
      {% endif %}
    </div>
  </body>
</html>
